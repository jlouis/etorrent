#!/bin/sh

# Most of this file was taken from the ejabberd project and then changed
#  until it matched what we had as a goal

# Example:
#
# BEAMDIR="apps/*/ebin deps/*/ebin"
# CONFIGFILE="rel/etorrent/etc/app.config"
# ERL_FLAGS=""

NODE=etorrent@127.0.0.1

BEAMDIR=%%%BEAMDIR%%%
CONFIGFILE=%%%CONFIGFILE%%%
ERL_FLAGS=%%%ERL_FLAGS%%%


BEAMDIR="apps/*/ebin deps/*/ebin"
CONFIGFILE="rel/etorrent/etc/app.config"
ERL_FLAGS=""

start () {
    erl ${ERL_FLAGS} -name ${NODE} -pa ${BEAMDIR} \
	-config ${CONFIGFILE} -noshell -noinput -detached \
	-s etorrent_app
}

console () {
    erl ${ERL_FLAGS} -name ${NODE} -pa ${BEAMDIR} \
	-config ${CONFIGFILE}  \
 	-s etorrent_app
}

debug () {
    erl -name debug${NODE} \
	-pa ${BEAMDIR} \
	-remsh ${NODE}
}

ctl () {
    erl -noinput -name etorrentctl \
	-pa ${BEAMDIR} \
	-s etorrent_ctl start ${NODE} $@
}

usage () {
    echo "Usage: $0 {start|stop|debug|console}"
}

[ $# -lt 1 ] && usage

case $1 in
    start) start;;
    console) console;;
    debug) debug;;
    *) ctl $@;;
esac
